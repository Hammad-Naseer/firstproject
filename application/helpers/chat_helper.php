<?php    function sendChatMessage($sender_id, $receiver_id, $sender_type, $receiver_type , $message){                $CI =& get_instance();        $CI->load->database();                $school_id = $_SESSION['school_id'];                $teacher_id = 0;	        $student_id	= 0;        $parent_id	= 0;         // set sender id        if($sender_type == "teacher"){            $teacher_id = $sender_id;        }        else if($sender_type == "parent"){            $parent_id = $sender_id;        }        else if($sender_type == "student"){            $student_id = $sender_id;        }                // set receiver id        if($receiver_type == "teacher"){            $teacher_id = $receiver_id;        }        else if($receiver_type == "parent"){            $parent_id = $receiver_id;        }        else if($receiver_type == "student"){            $student_id = $receiver_id;        }                $data_message = array(            'school_id'     => $school_id,            'teacher_id'    => $teacher_id,            'student_id'    => $student_id,            'parent_id'     => $parent_id,            'sender'        => $sender_id,            'sender_type'   => $sender_type,            'title'         => 'New Message',            'body'          => $message        ); 	    $CI->db->insert(get_school_db().".message" , $data_message);        }        function get_chat_message_list($user1Id , $user2Id , $user1Type , $user2Type)    {        $CI =& get_instance();        $CI->load->database();                       $school_id = $_SESSION['school_id'];        $where = "WHERE school_id = $school_id";                if($user1Type == "teacher"){            $where .= " AND teacher_id = $user1Id";        }        else if($user1Type == "parent"){            $where .= " AND parent_id  = $user1Id";        }        else if($user1Type == "student"){            $where .= " AND student_id = $user1Id";        }                if($user2Type == "teacher"){            $where .= " AND teacher_id = $user2Id";        }        else if($user2Type == "parent"){            $where .= " AND parent_id  = $user2Id";        }        else if($user2Type == "student"){            $where .= " AND student_id = $user2Id";        }                $where .= ' ORDER BY InsertedAt	desc';                $result = $CI->db->query("select * from " . get_school_db() . ".message where $where")->result_array();        return $result;                        }        ?>